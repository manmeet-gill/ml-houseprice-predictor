import pandas as pd
from sklearn.tree import DecisionTreeRegressor
from sklearn.model_selection import train_test_split

main_file_path = './train.csv' # this is the path to the Iowa data that you will use
data = pd.read_csv(main_file_path)

y=data.SalePrice

iowa_predictors_list=['LotArea', 'YearBuilt','1stFlrSF','2ndFlrSF','FullBath', 'BedroomAbvGr','TotRmsAbvGrd']

X = data[iowa_predictors_list]

iowa_model = DecisionTreeRegressor()

train_X, val_X, train_y, val_y = train_test_split(X,y, random_state=0)

iowa_model.fit(train_X,train_y)

print("Making predictions for the following 5 houses")
print(X.head())

print("The predictions are")
print(iowa_model.predict(X.head()))

from sklearn.metrics import mean_absolute_error

predicted_prices = iowa_model.predict(val_X)
print("MAE is ",mean_absolute_error(val_y, predicted_prices))